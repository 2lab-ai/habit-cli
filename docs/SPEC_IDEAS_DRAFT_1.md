# habit-cli — SPEC IDEAS DRAFT v0.1 (1차, 아이디어 전체 포함)

> 목적: 사장님이 던진 아이디어들을 **빠짐없이 수집**하고, 이후 리뷰/선별을 위한 **결정론적 문서 기반**을 만든다.
>
> 상태: **초안(아이디어 수집용)**. 여기 있는 모든 것을 v1에 넣는다는 의미가 아니다.

---

## 0) 핵심 원칙(현재까지 합의)

1) **habit-cli는 deterministic program**
- 자연어 파싱/대화 생성/갈굼은 OpenClaw(에이전트)가 담당.
- habit-cli는 명령/입력/상태 → 결과/상태전이가 항상 재현 가능.

2) **존나 빠르게 반응**
- 기본 명령은 p95 100ms 이내 목표(로컬).
- 네트워크/무거운 작업은 기본 플로우에서 금지. 별도 명령으로 분리.

3) **스케줄링/알림은 cron/OpenClaw**
- habit-cli는 상태/규칙/계산/로그.

4) **로컬 저장 + 암호화 + (향후) iPhone sync**
- v1에서는 iPhone 앱 제외.

---

## 1) 사장님 의도(제품 관점)

### 1.1 자동 등록(자연어 → CLI)
- 유저가 "나 매일 운동한다" 같이 말하면 에이전트가 구조화해서 habit-cli에 등록.

### 1.2 매일 질문/체크
- 매일 했는지 물어보고 기록.

### 1.3 NEW 습관은 선언문 강제
- 새로 시작하는 습관은 "했다고 인정"받으려면 선언문 형태가 필요.
- 예: "나는 2026년 1월 31일 10시경에 XXXX를 했습니다."
- 에이전트는 유저가 응답할 때까지 계속 유도.

### 1.4 트랩/패널티(자기 강제)
- 미이행 시 다음날 의무 증가(2배, cap 등).
- 예외 정책: 인정되는 예외/불인정 예외 구분.

### 1.5 루틴(습관 묶음 + 타이머)
- 예: 아침 9시 루틴: 샤워 10m → 밥 20m → 맨몸운동 10m.
- 9시에 "X루틴 시작하겠습니까?"(유저 확인) → 시작하면 세션이 타이머 기반으로 진행.
- 단계 완료/다음/스킵.
- 기상 루틴 예시: 물마시기/이불개기/명상(명언 출력)/인지 체크/휴대폰 앱 삭제(강제) 등.

### 1.6 외부 공개 트랩(커밋/해시체인/조건부 공개)
- 선언문은 암호화 저장.
- X에 해시체인 앵커를 올려 "그 시점에 뭔가를 선언했다"를 공개 증명.
- 조건부로 키/원문 공개가 가능(데드맨/미이행 시 점진적 공개).

### 1.7 (확장 아이디어) 제3자+결제+키 조각 공개
- 유저가 $1000 등을 서비스에 걸고 결제.
- 선언문 + 돈을 가져갈 수 있는 코드가 암호화되어 X에 업로드.
- 유저가 못할 때마다 키 조각이 하나씩 공개.
- 조각이 모이면 제3자가 내용을 보거나/코드를 클레임할 수 있음.

---

## 2) 기능 모듈로 분해(스펙 정리용)

> 이 섹션은 구현을 위한 분해이며, 우선순위/출시 포함 여부는 별도.

### M0: Core Tracking
- Habit, Checkin, Status, Stats, Archive

### M1: Declaration(선언)
- declare 기록(append-only), NEW habit 정책

### M2: Penalty/Trap Engine
- penalty rule(arm) + trigger(tick) + resolve/void
- 예외/쿼터

### M3: Routine Sessions
- routine template + routine session state + step timers

### M4: Crypto + Git Backup
- 로컬 암호화(선언/노트)
- private repo 백업(암호문만)

### M5: X Anchor / Deadman / Gradual Reveal
- 해시체인 앵커 텍스트 생성
- (옵션) 키 조각 공개 계획/상태

### M6: Payment/Marketplace (별도 서비스 가능성)
- 결제/에스크로/클레임 코드/제3자 참여

---

## 3) 결정 포인트(아직 미확정)

1) 선언문 강제 범위: NEW 습관에만? 모든 습관에 항상?
2) 루틴의 시간(9시 등)은 cron이 물어보는 트리거로만 쓰는가, habit-cli가 일정 개념을 갖는가?
3) 예외 정책(인정/불인정)과 quota를 어떤 단위로 강제할 것인가?
4) 외부 공개 트랩: 기본은 해시 앵커만 vs 조건부 원문 공개까지?
5) 결제/제3자 참여는 v1에서 제외하고 아이디어로만 둘 것인가?

---

## 4) 다음 단계(리뷰 요청 계획)

- 이 문서를 기준으로 oracle/np1/p9(대체)에게:
  1) 모듈 분해가 맞는지
  2) v1에 넣을 최소 코어가 무엇인지
  3) 위험(법/보안/계정/정신건강/스팸) 가드레일
  을 리뷰받고, 그 결과를 별도 문서로 취합한다.
